/* =========================================================
   MeasureLy — Full CSS Rewrite (cards are full-width)
   ========================================================= */

/* -------- Theme tokens -------- */
:root{
  color-scheme: light dark;

  /* spacing & radii */
  --pad:14px;
  --gap:12px;
  --radius:12px;

  /* palette (light) */
  --bg:#f4f5f7;
  --fg:#0f1115;
  --card-bg:#ffffff;
  --muted:#5b616e;
  --accent:#0969da;

  /* neutrals */
  --border: rgba(0,0,0,.18);
  --shadow-1: 0 1px 2px rgba(0,0,0,.05), 0 6px 16px rgba(0,0,0,.07);

  /* status tints (light) */
  --great:#e8f0ff;
  --good:#e8f7e8;
  --ok:#f6f3e6;
  --warn:#fff1e0;
  --poor:#ffe6e6;
}

@media (prefers-color-scheme: dark){
  :root{
    --bg:#0d1117;
    --fg:#eaeef2;
    --card-bg:#0f141b;
    --muted:#aab3c2;
    --accent:#7bb0ff;
    --border: rgba(255,255,255,.16);
    --shadow-1: 0 1px 2px rgba(0,0,0,.4), 0 6px 20px rgba(0,0,0,.45);

    --great:#131b33;
    --good:#112818;
    --ok:#292514;
    --warn:#3a2a16;
    --poor:#3a1717;
  }
}

/* -------- Reset & guards -------- */
*,*::before,*::after{ box-sizing:border-box; min-width:0; }
html,body{ margin:0; padding:0; background:var(--bg); color:var(--fg); overflow-x:hidden; }
body{
  font-family: system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
  font-size:17px; line-height:1.55;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  font-optical-sizing:auto;
  text-wrap:pretty;
}
img{ max-width:100%; height:auto; display:block; }
a{ color:inherit; text-underline-offset:2px; }
a:hover{ color:var(--accent); }
code,kbd,.value{
  font-family: ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;
  font-variant-numeric: tabular-nums;
}
pre{
  white-space:pre-wrap; word-break:break-word;
  border:1px solid var(--border); border-radius:var(--radius);
  padding:10px; max-height:260px; overflow:auto; background:var(--card-bg);
  box-shadow: 0 1px 1px rgba(0,0,0,.04);
}

/* -------- Accessibility helpers -------- */
.visually-hidden{
  position:absolute!important; height:1px; width:1px; overflow:hidden;
  clip:rect(1px,1px,1px,1px); white-space:nowrap; border:0; padding:0; margin:-1px;
}
.skip-link{ position:absolute; left:-9999px; top:auto; }
.skip-link:focus{
  left:10px; top:10px; z-index:1000; background:var(--card-bg); border:2px solid currentColor;
  padding:8px 12px; border-radius:8px;
}
a:focus-visible, select:focus-visible, input:focus-visible, .mly-link:focus-visible, button:focus-visible{
  outline:3px solid var(--accent); outline-offset:3px; border-radius:6px;
}
@media (forced-colors: active){
  :root{ --accent: Highlight; }
  *{ box-shadow:none !important; }
}

/* -------- Layout wrappers (cards are full width) -------- */
.wrap{
  padding:calc(var(--pad) + env(safe-area-inset-top,0px)) var(--pad) var(--pad);
  display:grid; gap:var(--pad);
  width:100%; max-width:none; /* no fixed page max-width */
}

/* Generic full-width card */
.card,
.io-box,
.result-box,
.mly-pre,
.svg-host{
  background:var(--card-bg);
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow-1);
  width:100%;
  max-width:100%;
  overflow:hidden;
}

/* Titles & text bits */
.card-title{ font-size:21px; font-weight:800; letter-spacing:.2px; color:inherit; margin:0 0 10px; }
.subhead{ font-size:15px; font-weight:600; letter-spacing:.1px; color:inherit; opacity:.9; margin:0 0 6px; }
.muted{ color:var(--muted); }
.small{ font-size:12.75px; }
.rule{ height:1px; background:var(--border); opacity:.18; margin:12px 0; }

/* -------- Header -------- */
header{
  position:sticky; top:0; z-index:20;
  display:flex; align-items:center; justify-content:space-between;
  padding:calc(var(--pad) + env(safe-area-inset-top,0px)) var(--pad) var(--pad);
  background:#161b22; color:#fff; border-bottom:1px solid rgba(255,255,255,.08);
  box-shadow:0 1px 0 #00000010;
}
header .logo{ height:40px; width:auto; }

/* Hamburger */
.hamburger{
  display:inline-flex; flex-direction:column; gap:5px;
  padding:8px; border:0; background:none; cursor:pointer; border-radius:8px;
}
.hamburger span{
  display:block; width:26px; height:2px; background:#fff; border-radius:2px;
}
.hamburger:hover{ background: color-mix(in oklab, var(--accent) 12%, transparent); }

/* Dropdown menu */
.menu[hidden]{ display:none !important; }
.menu{
  position:absolute; right:12px;
  top:calc(56px + env(safe-area-inset-top,0px));
  background:var(--card-bg); color:inherit;
  border:1px solid var(--border); border-radius:10px; padding:8px 0;
  box-shadow:0 6px 24px rgba(0,0,0,.18);
  max-width:min(92vw, 340px);
  overflow:auto; -webkit-overflow-scrolling:touch; z-index:1000;
}
.menu a{
  display:block; padding:12px 16px; text-decoration:none;
}
.menu a:hover{ text-decoration:underline; }

/* -------- Form controls -------- */
.with-unit{ position:relative; }
.with-unit input{
  width:100%; padding:12px 36px 12px 12px;
  border:1.25px solid var(--border); border-radius:10px;
  background:var(--card-bg); color:var(--fg); min-height:44px; font-size:16px;
  accent-color: var(--accent);
}
.with-unit input:focus{ border-color:var(--accent); box-shadow:0 0 0 3px color-mix(in oklab, var(--accent) 25%, transparent); }
.unit{
  position:absolute; right:10px; top:50%; transform:translateY(-50%);
  font-size:12.5px; opacity:.7; background:var(--card-bg); padding:0 6px; border-radius:6px;
}

/* -------- Buttons -------- */
button{
  appearance:none; background:var(--bg); color:var(--fg);
  border:1.25px solid var(--border); border-radius:12px;
  padding:14px 18px; font-weight:800; cursor:pointer;
  line-height:1; min-height:48px; transition:box-shadow .15s ease, transform .02s, background-color .15s;
}
button[disabled],button[aria-disabled="true"]{ opacity:.55; cursor:not-allowed; border-style:dashed; }
button:not(.primary):hover:not([disabled]){ background:var(--card-bg); border-color:var(--accent); color:var(--accent); }
button.primary{ background:var(--accent); border-color:var(--accent); color:#fff; }
button.primary:hover:not([disabled]){ filter:brightness(1.05); }
button:active{ transform:translateY(1px); }
.actions{ margin-top:16px; display:flex; gap:10px; align-items:center; flex-wrap:wrap; }

/* -------- IO blocks -------- */
.io-grid{ display:grid; gap:16px; grid-template-columns:1fr; } /* full width column */
.io-box{ padding:12px 14px; }
.io-head{ display:flex; align-items:center; justify-content:space-between; margin:0 0 8px; }
.io-label{ font-weight:700; font-size:16px; }
.status{
  font-size:13px; line-height:1; padding:6px 10px; border-radius:999px;
  border:1px solid var(--border); background:var(--ok);
}
.status.ok{ background:var(--good); }
.status.warn{ background:var(--warn); }
.io-name{
  font-family: ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;
  font-size:13px; color:var(--muted); opacity:.85; word-break:break-word; margin-top:4px;
}

/* -------- Results -------- */
.mly-title{
  margin:0 0 6px; display:flex; align-items:center; gap:8px; flex-wrap:wrap; background:transparent;
}
.mly-score{ font-weight:700; font-size:20px; }
.mly-badge{ border:1px solid var(--accent); border-radius:8px; padding:2px 8px; font-size:13px; background:transparent; }
.mly-headline{ margin:2px 0 12px; color:var(--muted); text-wrap:balance; }

.results-grid{ display:grid; gap:16px; grid-template-columns:1fr; } /* full width column */
.result-box{ padding:12px 14px; }
.result-head{ display:flex; align-items:center; justify-content:space-between; margin:0 0 8px; }
.result-label{ font-weight:700; font-size:16px; }
.result-pill{
  border:1px solid var(--border); border-radius:999px; padding:4px 10px; font-size:13px; background:var(--card-bg); white-space:nowrap;
}
.result-pill.great{ background:var(--great); }
.result-pill.good{ background:var(--good); }
.result-pill.ok{ background:var(--ok); }
.result-pill.warn{ background:var(--warn); }
.result-pill.poor{ background:var(--poor); }
.result-desc{ font-size:14px; color:var(--muted); line-height:1.45; }
.result-actions{ margin:6px 0 0 18px; }
.result-actions li{ margin:6px 0; }

/* Section Scores — keep internal grid responsive inside a full-width card */
#sectionScoresCard{ width:100%; max-width:100%; }
#sectionScoresGrid{
  display:grid;
  grid-template-columns:repeat(6, minmax(0,1fr));
  gap:12px;
  width:100%; min-width:0;
}
#sectionScoresGrid .mly-item{
  display:flex; align-items:center; justify-content:space-between;
  padding:10px 12px; background:var(--card-bg);
  border:1px solid var(--border); border-radius:10px;
  box-shadow:0 1px 2px rgba(0,0,0,.05);
  min-width:0;
}
#sectionScoresGrid .mly-pill{ white-space:nowrap; }
@media (max-width:1100px){ #sectionScoresGrid{ grid-template-columns:repeat(3, minmax(0,1fr)); } }
@media (max-width:640px){  #sectionScoresGrid{ grid-template-columns:repeat(2, minmax(0,1fr)); } }

/* Guard the whole Results area from weird parent constraints */
#resultCard, #sectionScoresCard{ width:100%; max-width:100%; }
#resultCard *, #sectionScoresCard *{ min-width:0; }

/* -------- Geek / details -------- */
.mly-link{ cursor:pointer; text-decoration:underline; display:inline-block; margin-top:8px; }
.mly-pre{
  padding:10px; overflow:auto; max-height:50vh;
}
.mly-empty{ max-width:720px; margin:8px 0; text-align:center; color:var(--muted); }

/* -------- Sessions list -------- */
#sessions a{
  display:block; padding:10px 12px; border:1px solid var(--border);
  border-radius:8px; background:var(--card-bg); text-decoration:none;
}
#sessions a + a{ margin-top:8px; }
#sessions a:hover{ border-color:var(--accent); color:var(--accent); }

/* -------- Graphs -------- */
#graphs{
  display:grid; gap:12px;
  grid-template-columns:1fr;        /* full-width single column container */
}
.graph-wrap{ display:grid; gap:10px; contain:layout paint; }
.graph-toolbar{ display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
.graph-toolbar select,.graph-toolbar label{ font-size:14px; }
.graph-legend{ display:flex; gap:8px; flex-wrap:wrap; }
.legend-item{ display:flex; align-items:center; gap:6px; font-size:13px; }
.legend-swatch{ width:14px; height:4px; border-radius:2px; background:currentColor; }
.svg-host{
  width:100%; height:auto; min-height:320px; aspect-ratio:16/9;
  overflow:clip; background:var(--card-bg);
}

/* -------- Compact card tweak (still full width) -------- */
.card.compact .subhead{ margin:2px 0 4px; }
.card.compact .hint{ margin:0 0 6px; }

/* -------- Motion prefs -------- */
@media (prefers-reduced-motion: reduce){
  *{ animation:none!important; transition:none!important; }
}
@media (prefers-reduced-motion: no-preference){
  .menu, button, .card{ transition: box-shadow .2s ease, transform .12s ease, background-color .15s; }
  .menu a:hover{ background: color-mix(in oklab, var(--accent) 10%, transparent); }
}

/* Add near the end of your CSS (after the card rules) */
:root{
  --card-pad: 16px; /* adjust to taste; 20px if you want airier cards */
}

.card,
.io-box,
.result-box{
  padding: var(--card-pad);
}

/* Optional: if you want a little breathing room around embedded SVG canvases too */
.svg-host{
  padding: 8px;          /* or remove if your charts draw edge-to-edge */
  border-radius: calc(var(--radius) - 2px);
}

/* Hamburger contrast fix */
header .hamburger{
  color:#fff;                    /* default line color on dark header */
}
header .hamburger span{
  background: currentColor;      /* lines follow the button's color */
}

/* On hover/focus: give a light-ish background and switch lines to dark */
header .hamburger:hover,
header .hamburger:focus-visible{
  background: rgba(255,255,255,.16);  /* visible on dark header without going full white */
  color:#111;                         /* makes the lines dark so they stand out */
  outline: none;                      /* focus ring handled by background + below rule */
}

/* If you still want a focus ring, add this: */
header .hamburger:focus-visible{
  box-shadow: 0 0 0 3px color-mix(in oklab, var(--accent) 35%, transparent);
  border-radius: 8px;
}

/* Optional: when the menu is open (aria-expanded="true"), keep it in the 'active' state */
header .hamburger[aria-expanded="true"]{
  background: rgba(255,255,255,.16);
  color:#111;
}

/* FIX 1: Don't recolor the hamburger on hover */
button:not(.primary):not(.hamburger):hover:not([disabled]){
  background: var(--card-bg);
  border-color: var(--accent);
  color: var(--accent);
}

/* Keep hamburger readable on hover / when open */
header .hamburger{ color:#fff; }              /* bars are white on dark header */
header .hamburger span{ background: currentColor; }
header .hamburger:hover,
header .hamburger[aria-expanded="true"]{
  background: rgba(255,255,255,.16);
  color:#111;                                 /* bars go dark against the lighter bg */
}

/* FIX 2: Make menu text visible by default (no white-on-white) */
.menu{
  background: var(--card-bg);
  color: var(--fg);                           /* stop inheriting white from header */
}
.menu a{
  color: var(--fg);
}
.menu a:hover{
  color: var(--accent);
  background: color-mix(in oklab, var(--accent) 10%, transparent);
}

/* If something else is still forcing white, harden it: */
header .menu, header .menu a{ color: var(--fg) !important; }
